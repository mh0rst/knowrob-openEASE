{% extends "layout_header.html" %}

{% block head %}
  <meta charset="utf-8" />
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='lib/font/font.css') }}" />
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/screen.css') }}"/>
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/layout-default-1.4.0.css') }}" />
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/user.css') }}"/>
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/dat.gui.css') }}"/>
  
  <script type="text/javascript" src="{{ url_for('static', filename='openease.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/EASE.js') }}"></script>

  <script type="text/javascript" src="{{ url_for('static', filename='lib/chart/google-jsapi.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/chart/DonutChart.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/chart/BarChart.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/chart/TreeDiagram.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/chart/Timeline.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/chart/DataVisClient.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/chart/TaskTreeVisClient.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/chart/array-nonstandard.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/chart/Control.js') }}"></script>

  <script type="text/javascript" src="{{ url_for('static', filename='lib/utility.js') }}"></script>
  
  <script type="text/javascript" src="{{ url_for('static', filename='lib/ros/JSONProlog.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/ros/MarkerArrayClient.js') }}"></script>

  <script type="text/javascript" src="{{ url_for('static', filename='lib/controller.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/canvas.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/console.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/framecontrol.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/webclient.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/episode.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/menu.js') }}"></script>
  
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/Viewer.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/shader/BasicShader.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/shader/CopyShader.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/shader/FXAAShader.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/shader/SAOShader.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/shader/SSAOShader.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/shader/SepiaShader.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/shader/CelShader.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/shader/OutlineShader.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/shader/UnpackDepthRGBAShader.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/shader/DepthLimitedBlurShader.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/EffectComposer.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/passes/ShaderPass.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/passes/TexturePass.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/passes/ClearPass.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/passes/HighlightingPass.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/passes/RenderPass.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/passes/SAOPass.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/passes/SSAOPass.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/passes/OutlinePass.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/vis/passes/CelShadingPass.js') }}"></script>

  <script type="text/javascript" src="{{ url_for('static', filename='lib/designator/desig.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='lib/designator/adt.js') }}"></script>
{% endblock %}

{% block content %}
  <script type="text/javascript">

    var WEBCLIENT_USER_IFACES = [
        { id: 'cog', name: 'Cognitive Capabilities', interfaces: [
          { id: 'kb', name: 'Question Answering', src:'/knowrob' },
          { id: 'replay', name: 'Episode Replay', src:'/video' }
        ]}
    ];
    var auth = '{{ authentication }}';
    var wsproto = 'ws' + (location.protocol === 'https:'?'s':'');
    var rosUrl = wsproto + '://{{ host_url }}/ws/{{ container_name }}/';
    var controller = new OpenEASEController();
    var frameControl = new FrameControl({
            menu: menu,
            common_user_interfaces: COMMON_OPENEASE_USER_IFACES
    });
    var client = new KnowrobClient({
            frameControl: frameControl,
            ros_url: rosUrl,
            authentication: auth,
            auth_url: '/api/v1.0/auth_by_session',
            meshPath: '/meshes/',
            category: '{{ category }}',
            episode: '{{ exp }}',
            require_episode: true,
            use_console_overlay: true
        });
    controller.registerClient(client);
    $(document).ready(function () {
        menu.update_webclient_interfaces(WEBCLIENT_USER_IFACES);
        client.init();
        frameControl.init();
        frameControl.update_webclient_frames(WEBCLIENT_USER_IFACES);
        $(window).load(frameControl.updateLocation);
        $(window).bind('hashchange', frameControl.updateLocation);
    });
  </script>
  
  <div class="page" id="page" />
{% endblock %}
